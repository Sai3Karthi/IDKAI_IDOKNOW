/* ExpandablePerspectiveCards (epc-*) */

.epc-root { width: 100%; }

/* Pull cards higher: add optional modifier class for tighter top spacing */
.epc-root.epc-compact { margin-top:0; padding-top:0.25rem; }

.epc-grid {
  display:flex;
  gap:0.85rem; /* slightly tighter */
  width:100%;
  flex-wrap:nowrap;
  align-items:stretch;
  overflow-x:visible;
  /* Remove any unintended top offset */
  margin-top:0.25rem;
}
/* fallback to original responsive stacking on small widths */
@media (max-width: 900px){
  .epc-grid { flex-wrap:wrap; }
  .epc-card { flex:1 1 180px; }
}

.epc-card {
  position: relative;
  border: none;
  outline: none;
  cursor: pointer;
  padding: 0;
  border-radius: 0.9rem;
  height: 10.5rem; /* slightly reduced height to fit more above the fold */
  overflow: hidden;
  color: hsl(var(--foreground));
  box-shadow: 0 4px 18px -2px hsl(var(--foreground)/0.15);
  transition: box-shadow .28s ease, transform .28s ease, flex .4s cubic-bezier(.16,.8,.24,1), width .4s cubic-bezier(.16,.8,.24,1);
  display: flex;
  align-items: flex-end;
  text-align: left;
  background: hsl(var(--card));
  backdrop-filter: blur(6px);
  flex:1 1 0;
  min-width:140px;
}
.epc-card:focus-visible { box-shadow: 0 0 0 3px hsl(var(--ring)/0.5); }
.epc-card:hover { box-shadow: 0 10px 28px -4px hsl(var(--foreground)/0.25); }

/* squeeze behavior: hovered grows, siblings shrink via data attribute */
.epc-grid[data-hovering] .epc-card { flex:0.85 1 0; }
.epc-grid[data-hovering] .epc-card[data-active-hover] { flex:1.6 1 0; }
.epc-grid[data-hovering] .epc-card[data-active-hover] .epc-card-title { font-size:1.1rem; }

.epc-card-shade {
  position:absolute;inset:0;
  background:linear-gradient(to bottom,rgba(0,0,0,0) 20%,rgba(0,0,0,.65) 90%);
  pointer-events:none;
}

.epc-card-body { position:relative; z-index:2; padding:0.75rem 0.9rem 0.85rem; width:100%; }
.epc-card-title { margin:0 0 .2rem; font-size:0.95rem; font-weight:600; letter-spacing:.5px; }
.epc-card-count { margin:0; font-size:.7rem; opacity:.85; }
.epc-card-cta { position:absolute; top:.55rem; right:.65rem; font-size:.6rem; background:rgba(255,255,255,.25); padding:.22rem .5rem; border-radius:999px; backdrop-filter:blur(3px); }

/* Overlay & dialog */
.epc-overlay { position:fixed; inset:0; background:rgba(0,0,0,.55); backdrop-filter:blur(2px); z-index:60; }
/* Reduced vertical padding so dialog appears higher */
.epc-dialog-wrapper { position:fixed; inset:0; z-index:70; padding:0.75rem 1.25rem 2.5rem 1.25rem; display:flex; align-items:flex-start; justify-content:flex-start; }
/* sheet variant: left aligned */
.epc-dialog-sheet { display:flex; align-items:flex-start; justify-content:flex-start; padding:0.9rem 1.5rem 0 1.5rem; width:100%; }
@media (max-height: 720px) {
  .epc-dialog-wrapper { padding-bottom:1.75rem; }
  .epc-dialog-sheet { padding-top:0.5rem; }
}
.epc-dialog-sheet .epc-dialog { max-width:620px; margin-left:0; }
.epc-dialog { background:hsl(var(--card)); color:hsl(var(--card-foreground)); width:100%; max-width:520px; border-radius:1.05rem; box-shadow:0 18px 48px -12px rgba(0,0,0,.65); position:relative; display:flex; flex-direction:column; max-height:70vh; height:min(620px,70vh); border:1px solid hsl(var(--border)); backdrop-filter:blur(10px) saturate(140%); overflow:hidden; margin-top:0; }

.epc-hero { height:150px; width:100%; border-radius:1.05rem 1.05rem 0 0; }
.epc-dialog-sheet .epc-hero { height:100px; }
.epc-hero { position:relative; }
.epc-hero-overlay { 
  position:absolute; inset:0; 
  display:flex; 
  align-items:center; 
  justify-content:center; 
  padding:0.75rem 1rem; 
  text-align:center; 
  background:linear-gradient(to top,rgba(0,0,0,.55),rgba(0,0,0,0)); 
}
.epc-metrics { 
  display:flex; 
  gap:1.2rem; 
  font-size:.6rem; 
  letter-spacing:.5px; 
  font-weight:500; 
  align-items:center; 
  justify-content:center; 
  flex-wrap:wrap; 
}
.epc-metric { 
  display:flex; 
  flex-direction:column; 
  gap:.2rem; 
  align-items:center; 
  text-align:center; 
}
.epc-metric label { 
  font-size:.7rem; 
  text-transform:uppercase; 
  opacity:.7; 
  font-weight:600; 
  letter-spacing:1.5px; 
}
.epc-metric strong { 
  font-size:clamp(2.4rem, 4vw + .75rem, 3.6rem); 
  font-weight:700; 
  line-height:1.05; 
  letter-spacing:.5px; 
}
.epc-metrics-fallback .epc-metric strong { opacity:.85; }
.epc-close { position:absolute; top:.6rem; right:.6rem; background:hsl(var(--background)/0.85); color:hsl(var(--foreground)); border:1px solid hsl(var(--border)); border-radius:999px; padding:.38rem; cursor:pointer; display:flex; align-items:center; justify-content:center; box-shadow:0 2px 6px rgba(0,0,0,.25); backdrop-filter:blur(6px); }
.epc-close:hover { background:hsl(var(--background)/0.9); }
.epc-close:hover { transform:scale(1.06); }
.epc-close:active { transform:scale(.94); }

.epc-content { padding:0.85rem 0.95rem 1rem; display:flex; flex-direction:column; gap:.45rem; min-height:0; flex:1; }
.epc-heading { margin:0; font-size:1.2rem; font-weight:600; }
.epc-sub { margin:0; font-size:.75rem; opacity:.75; }
.epc-scroll { flex:1; min-height:0; overflow-y:auto; padding:.2rem .12rem .75rem .12rem; position:relative; overscroll-behavior:contain; }
.epc-scroll:after { content:""; position:sticky; bottom:0; left:0; right:0; height:34px; pointer-events:none; background:linear-gradient(to bottom,rgba(0,0,0,0),rgba(0,0,0,0.55)); border-radius:0 0 1.05rem 1.05rem; }
.epc-scroll::-webkit-scrollbar { width:6px; }
.epc-scroll::-webkit-scrollbar-track { background:transparent; }
.epc-scroll::-webkit-scrollbar-thumb { background:rgba(120,120,120,.35); border-radius:8px; }
.epc-scroll::-webkit-scrollbar-thumb:hover { background:rgba(120,120,120,.55); }

.epc-list { list-style:none; margin:0; padding:0 .35rem 0 .18rem; display:flex; flex-direction:column; gap:.4rem; }
.epc-item { font-size:.75rem; line-height:1.1rem; padding:.5rem .7rem .5rem .85rem; background:hsl(var(--muted)/0.28); border-left:2px solid transparent; border-radius:.55rem; box-shadow:0 1px 2px rgba(0,0,0,.4), 0 0 0 1px hsl(var(--border)/0.25); transition:background .18s ease,border-color .25s ease, box-shadow .25s ease, transform .28s cubic-bezier(.16,.8,.24,1); outline:none; position:relative; }
.epc-item:hover { background:hsl(var(--muted)/0.42); transform:translateY(-3px) scale(1.035); box-shadow:0 6px 18px -4px rgba(0,0,0,.55), 0 0 0 1px hsl(var(--border)/0.35); }
.epc-item:focus-visible { background:hsl(var(--muted)/0.45); transform:translateY(-3px) scale(1.04); box-shadow:0 0 0 2px hsl(var(--ring)/0.85), 0 6px 18px -4px rgba(0,0,0,.55), 0 0 0 1px hsl(var(--border)/0.4); }
.epc-item:active { transform:translateY(-1px) scale(1.01); transition-duration:90ms; }

.epc-empty { font-size:.7rem; opacity:.7; padding:.65rem; text-align:center; }
.epc-placeholder { grid-column:1/-1; text-align:center; font-size:.75rem; opacity:.6; padding:1.1rem 0; }

@media (prefers-reduced-motion:reduce){
  .epc-card, .epc-dialog { transition:none !important; animation:none !important; }
}

.epc-dialog-center { 
  display:flex; 
  align-items:center; 
  justify-content:center; 
  padding:0; 
  position:fixed; 
  inset:0; 
  pointer-events:none; /* allow overlay click detection outside dialog via outside-click hook */
  z-index:80; 
}
.epc-dialog-center .epc-dialog { pointer-events:auto; }